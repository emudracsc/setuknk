<!DOCTYPE html>
<html lang="en">
<head>
    <base target="_top">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSC ‡§°‡•á‡§ü‡§æ ¬∑ ‡§™‡•ç‡§∞‡•Ä‡§Æ‡§ø‡§Ø‡§Æ ‡§°‡•Ö‡§∂‡§¨‡•ã‡§∞‡•ç‡§°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        :root {
            --bg-gradient-1: #e0e5ec;
            --bg-gradient-2: #f0f4fa;
            --main-bg: rgba(255,255,255,0.85);
            --card-bg: rgba(255,255,255,0.75);
            --text-primary: #0b2b4a;
            --text-secondary: #102a41;
            --border-light: rgba(255,255,255,0.7);
            --badge-bg: #dff0d8;
            --badge-text: #1f5130;
            --badge-border: #bde0bd;
            --id-bg: rgba(255,255,255,0.7);
            --copy-btn-bg: white;
            --copy-btn-text: #1a73e8;
            --copy-btn-border: #1a73e8;
            --table-row-bg: rgba(255,255,255,0.3);
            --table-row-hover: rgba(255,255,255,0.7);
            --th-bg: #1a73e8;
            --th-text: white;
        }

        body.dark-theme {
            --bg-gradient-1: #1a2634;
            --bg-gradient-2: #2d3748;
            --main-bg: rgba(30,41,59,0.9);
            --card-bg: rgba(30,41,59,0.85);
            --text-primary: #e2e8f0;
            --text-secondary: #cbd5e0;
            --border-light: rgba(255,255,255,0.1);
            --badge-bg: #2d4a3e;
            --badge-text: #9ae6b4;
            --badge-border: #2f855a;
            --id-bg: rgba(45,55,72,0.8);
            --copy-btn-bg: #2d3748;
            --copy-btn-text: #90cdf4;
            --copy-btn-border: #4299e1;
            --table-row-bg: rgba(45,55,72,0.5);
            --table-row-hover: rgba(45,55,72,0.8);
            --th-bg: #2c5282;
            --th-text: #e2e8f0;
        }

        body {
            background: linear-gradient(145deg, var(--bg-gradient-1), var(--bg-gradient-2));
            min-height: 100vh;
            padding: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s ease;
        }

        .dashboard {
            max-width: 1400px;
            width: 100%;
            display: flex;
            gap: 24px;
            height: 92vh;
        }

        .main {
            flex: 1;
            background: var(--main-bg);
            backdrop-filter: blur(16px);
            border-radius: 40px;
            padding: 28px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 45px -15px rgba(0,30,60,0.25);
            border: 1px solid var(--border-light);
        }

        .main-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .main h2 {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .theme-toggle {
            background: var(--card-bg);
            border: 1px solid var(--border-light);
            border-radius: 50px;
            padding: 8px 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-primary);
        }

        .sidebar {
            width: 300px;
            display: flex;
            flex-direction: column;
            gap: 18px;
            overflow-y: auto;
        }

        .card {
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            padding: 22px 20px;
            border-radius: 32px;
            border: 1px solid var(--border-light);
        }

        .card h4 {
            color: var(--text-primary);
            margin-bottom: 16px;
            border-bottom: 2px solid rgba(26,115,232,0.2);
            padding-bottom: 10px;
        }

        .card input {
            width: 100%;
            padding: 14px 18px;
            margin-bottom: 18px;
            border-radius: 24px;
            border: 1px solid var(--border-light);
            background: var(--id-bg);
            color: var(--text-primary);
            outline: none;
        }

        .btn {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 40px;
            font-weight: 600;
            color: white;
            cursor: pointer;
        }

        .card:nth-child(1) .btn { background: #5f6368; }
        .card:nth-child(2) .btn { background: #34a853; }
        .card:nth-child(3) .btn { background: #d93025; }
        .card:nth-child(4) .btn { background: #1a73e8; }

        .search-box {
            width: 100%;
            padding: 18px 28px;
            border-radius: 60px;
            border: 1px solid var(--border-light);
            background: var(--id-bg);
            color: var(--text-primary);
            margin-bottom: 24px;
            font-size: 1rem;
            outline: none;
        }

        .table-wrap {
            flex: 1;
            overflow-y: auto;
            border-radius: 28px;
            background: var(--table-row-bg);
            border: 1px solid var(--border-light);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
            min-width: 850px;
        }

        th {
            background: var(--th-bg);
            color: var(--th-text);
            padding: 18px 16px;
            position: sticky;
            top: 0;
        }

        td {
            padding: 16px;
            border-bottom: 1px solid var(--border-light);
            background: var(--table-row-bg);
            color: var(--text-secondary);
        }

        tr:hover td {
            background: var(--table-row-hover);
        }

        .sr-no {
            background: rgba(26,115,232,0.2);
            padding: 5px 10px;
            border-radius: 30px;
            display: inline-block;
            color: var(--copy-btn-text);
        }

        .id-container {
            display: flex;
            align-items: center;
            gap: 5px;
            flex-wrap: wrap;
        }

        .id-number {
            font-family: monospace;
            background: var(--id-bg);
            padding: 4px 8px;
            border-radius: 30px;
            border: 1px solid var(--copy-btn-border);
            color: var(--text-primary);
        }

        .copy-btn {
            background: var(--copy-btn-bg);
            border: 1px solid var(--copy-btn-border);
            color: var(--copy-btn-text);
            padding: 4px 8px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 0.65rem;
        }

        .copy-btn.copied {
            background: #34a853;
            color: white;
            border-color: #34a853;
        }

        .name-download-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 5px;
        }

        .status-badge {
            background: var(--badge-bg);
            color: var(--badge-text);
            padding: 4px 8px;
            border-radius: 40px;
            font-size: 0.7rem;
            border: 1px solid var(--badge-border);
        }

        .download-btn {
            background: #34a853;
            color: white;
            padding: 4px 10px;
            border-radius: 30px;
            font-size: 0.65rem;
            border: none;
            cursor: pointer;
        }

        #loader {
            text-align: center;
            padding: 15px;
            display: none;
            background: rgba(255,255,255,0.6);
            border-radius: 60px;
            margin-bottom: 16px;
            color: var(--text-primary);
        }

        .loader-spinner {
            display: inline-block;
            width: 18px;
            height: 18px;
            border: 3px solid rgba(26,115,232,0.2);
            border-top: 3px solid #1a73e8;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin-right: 8px;
        }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

<div class="dashboard">
    <div class="main">
        <div class="main-header">
            <h2>üîé CSC ‡§°‡•á‡§ü‡§æ ‡§∂‡•ã‡§ß ¬∑ ‡§™‡•ç‡§∞‡•Ä‡§Æ‡§ø‡§Ø‡§Æ ‡§Ü‡§µ‡•É‡§§‡•ç‡§§‡•Ä</h2>
            <button class="theme-toggle" onclick="toggleTheme()">
                <span class="icon" id="themeIcon">üåû</span>
                <span id="themeText">Light Mode</span>
            </button>
        </div>
        <input type="text" id="searchInput" class="search-box" placeholder="‡§®‡§æ‡§µ, ID, ‡§ï‡§ø‡§Ç‡§µ‡§æ ‡§∏‡•á‡§µ‡§æ ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞‡§æ..." oninput="search(this.value)">
        <div id="loader"><span class="loader-spinner"></span> ‡§≤‡•ã‡§° ‡§π‡•ã‡§§ ‡§Ü‡§π‡•á...</div>
        <div class="table-wrap">
            <table>
                <thead>
                    <tr>
                        <th>‡§ï‡•ç‡§∞.</th>
                        <th>‡§∏‡•á‡§µ‡§æ ‡§®‡§æ‡§µ</th>
                        <th>‡§§‡§æ‡§∞‡•Ä‡§ñ</th>
                        <th>‡§Ö‡§∞‡•ç‡§ú ‡§ï‡•ç‡§∞‡§Æ‡§æ‡§Ç‡§ï</th>
                        <th>‡§®‡§æ‡§µ / ‡§°‡§æ‡§ä‡§®‡§≤‡•ã‡§°</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
    </div>

    <div class="sidebar">
        <div class="card">
            <h4>üìä ‡§∏‡•ç‡§ü‡•á‡§ü‡§∏</h4>
            <button class="btn" onclick="go('st')">‡§ö‡•á‡§ï ‡§∏‡•ç‡§ü‡•á‡§ü‡§∏</button>
        </div>
        <div class="card">
            <h4>üìú ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡§™‡§§‡•ç‡§∞</h4>
            <input type="text" id="d_id" placeholder="App ID">
            <button class="btn" onclick="go('dl')">‡§°‡§æ‡§ä‡§®‡§≤‡•ã‡§°</button>
        </div>
        <div class="card">
            <h4>üìé ‡§¶‡§∏‡•ç‡§§‡§ê‡§µ‡§ú</h4>
            <input type="text" id="u_id" placeholder="App ID">
            <button class="btn" onclick="go('up')">‡§Ö‡§™‡§≤‡•ã‡§°</button>
        </div>
        <div class="card">
            <h4>üìÑ ‡§™‡•ç‡§∞‡§§‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§§‡•ç‡§∞</h4>
            <input type="text" id="p_id" placeholder="App ID">
            <button class="btn" onclick="go('print')">‡§™‡•ç‡§∞‡§ø‡§Ç‡§ü ‡§ï‡§∞‡§æ</button>
        </div>
    </div>
</div>

<script>
    // üî¥ ‡§Ø‡•á‡§•‡•á ‡§§‡•Å‡§Æ‡§ö‡•Ä Google Sheet ‡§ö‡•Ä URL ‡§ü‡§æ‡§ï‡§æ (‡§™‡§æ‡§Ø‡§∞‡•Ä 2 ‡§Æ‡§ß‡•Ä‡§≤)
    const SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSJYD8WoQCixMu3zKw75gtszSB-afRR2sFWEc8N862atbprHVKklvoVgMBvE96bLhn37fI6bxoCAYna/pubhtml';
    
    let allData = [];

    function toggleTheme() {
        document.body.classList.toggle('dark-theme');
        const isDark = document.body.classList.contains('dark-theme');
        document.getElementById('themeIcon').textContent = isDark ? 'üåô' : 'üåû';
        document.getElementById('themeText').textContent = isDark ? 'Dark Mode' : 'Light Mode';
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
    }

    window.onload = function() {
        if (localStorage.getItem('theme') === 'dark') {
            document.body.classList.add('dark-theme');
            document.getElementById('themeIcon').textContent = 'üåô';
            document.getElementById('themeText').textContent = 'Dark Mode';
        }
        // ‡§•‡•á‡§ü ‡§°‡•á‡§Æ‡•ã ‡§°‡•á‡§ü‡§æ ‡§¶‡§æ‡§ñ‡§µ‡§æ
        showDemoData();
    };

    let timer;
    function search(v) {
        clearTimeout(timer);
        timer = setTimeout(() => {
            const filtered = allData.filter(row => 
                (row.name && row.name.toLowerCase().includes(v.toLowerCase())) ||
                (row.id && row.id.toLowerCase().includes(v.toLowerCase()))
            );
            render(filtered);
        }, 500);
    }

    function showDemoData() {
        allData = [
            { srNo: '1', service: 'Income Certificate', date: '10/02/2025', id: 'CSC2402A11', name: '‡§∞‡§æ‡§ú‡•á‡§∂ ‡§∂‡§∞‡•ç‡§Æ‡§æ' },
            { srNo: '2', service: 'Non-Creamy Layer', date: '09/02/2025', id: 'CSC2402B45', name: '‡§∏‡§µ‡§ø‡§§‡§æ ‡§™‡§æ‡§ü‡•Ä‡§≤' },
            { srNo: '3', service: 'Age Nationality', date: '08/02/2025', id: 'CSC2402C78', name: '‡§ó‡§£‡•á‡§∂ ‡§ï‡§¶‡§Æ' },
            { srNo: '4', service: 'Income Certificate', date: '07/02/2025', id: 'CSC2402D92', name: '‡§™‡•ç‡§∞‡§ø‡§Ø‡§Ç‡§ï‡§æ ‡§ú‡§æ‡§ß‡§µ' },
            { srNo: '5', service: 'Migrant Caste', date: '06/02/2025', id: 'CSC2402E33', name: '‡§∏‡•Ç‡§∞‡§ú ‡§Ø‡§æ‡§¶‡§µ' },
            { srNo: '6', service: 'Income Certificate', date: '28/02/2025', id: '2452942771251600076386', name: 'Mahesh Atmaram Patil' },
            { srNo: '7', service: 'Income Certificate', date: '28/02/2025', id: '2452942771251600076422', name: 'Vinayak Laxman Pawar' },
            { srNo: '8', service: 'Income Certificate', date: '28/02/2025', id: '2452942771251600076429', name: 'Tushar Suresh Desai' },
            { srNo: '9', service: 'Age Nationality', date: '03/01/2025', id: '2452942771253600076453', name: 'Vidyadhar Shashikant' },
            { srNo: '14', service: 'Income Certificate', date: '03/01/2025', id: '2452942771251600076459', name: 'Demo User 1' },
            { srNo: '15', service: 'Non-Creamy Layer', date: '03/01/2025', id: '2452942771286600076446', name: 'Demo User 2' },
            { srNo: '16', service: 'Age Nationality', date: '03/01/2025', id: '2452942771253600076460', name: 'Demo User 3' },
            { srNo: '17', service: 'Non-Creamy Layer', date: '03/01/2025', id: '2452942771286600076444', name: 'Demo User 4' }
        ];
        render(allData);
    }

    function render(data) {
        const tbody = document.getElementById('tableBody');
        if (!data || data.length === 0) {
            tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;padding:40px;">üîç ‡§ï‡•ã‡§£‡§§‡§æ‡§π‡•Ä ‡§°‡•á‡§ü‡§æ ‡§∏‡§æ‡§™‡§°‡§≤‡§æ ‡§®‡§æ‡§π‡•Ä</td></tr>';
            return;
        }

        let html = '';
        for (let i = 0; i < data.length; i++) {
            const r = data[i];
            const id = (r.id || '').replace(/'/g, "\\'");
            
            html += '<tr>' +
                '<td><span class="sr-no">' + (r.srNo || '-') + '</span></td>' +
                '<td><b>' + (r.service || '') + '</b></td>' +
                '<td>' + (r.date || '') + '</td>' +
                '<td><div class="id-container"><span class="id-number">' + (r.id || '') + '</span><button class="copy-btn" onclick="copyId(\'' + id + '\', this)">üìã ‡§ï‡•â‡§™‡•Ä</button></div></td>' +
                '<td><div class="name-download-container"><span class="status-badge">' + (r.name || '') + '</span><button class="download-btn" onclick="openPDF(\'' + id + '\')">‚¨áÔ∏è PDF</button></div></td>' +
            '</tr>';
        }
        tbody.innerHTML = html;
    }

    function copyId(id, btn) {
        navigator.clipboard.writeText(id).then(() => {
            btn.classList.add('copied');
            btn.innerHTML = '‚úì ‡§ï‡•â‡§™‡•Ä';
            setTimeout(() => {
                btn.classList.remove('copied');
                btn.innerHTML = 'üìã ‡§ï‡•â‡§™‡•Ä';
            }, 2000);
        });
    }

    function openPDF(id) {
        if (id) {
            window.open('https://cscservices.mahaonline.gov.in/Edistrict/Handler/GetFile.ashx?From=ApplicationStatus&ID=' + id + '&sDist=529', '_blank');
        }
    }

    function go(type) {
        let id = '', url = '';
        if (type === 'print') { 
            id = document.getElementById('p_id').value; 
            url = 'https://cscservices.mahaonline.gov.in/General_Affidavit/GeneralAffidavitCertificateEn.aspx?AppID=' + id + '&ServiceId=1268'; 
        }
        else if (type === 'dl') { 
            id = document.getElementById('d_id').value; 
            url = 'https://cscservices.mahaonline.gov.in/Edistrict/Handler/GetFile.ashx?From=ApplicationStatus&ID=' + id + '&sDist=529'; 
        }
        else if (type === 'up') { 
            id = document.getElementById('u_id').value; 
            url = 'https://cscservices.mahaonline.gov.in/Edistrict/WorkFlow/Attachment.aspx?ApplicantId=' + id + '&ServiceID=1253&ID=INIT'; 
        }
        else if (type === 'st') { 
            url = 'https://revenue.mahaonline.gov.in/ApplicationSearchStatus/ApplicationStatus.aspx?ServiceID=1&sDist=529'; 
        }
        
        if (type !== 'st' && !id) { 
            alert('‚ùå App ID ‡§ü‡§æ‡§ï‡§æ'); 
            return; 
        }
        window.open(url, '_blank');
    }
</script>
</body>
</html>

