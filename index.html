<!DOCTYPE html>
<html lang="en">
<head>
    <base target="_top">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSC ‡§°‡•á‡§ü‡§æ ¬∑ ‡§™‡•ç‡§∞‡•Ä‡§Æ‡§ø‡§Ø‡§Æ ‡§°‡•Ö‡§∂‡§¨‡•ã‡§∞‡•ç‡§° (GitHub)</title>
    <style>
        /* ‡§§‡•Å‡§Æ‡§ö‡•á ‡§∏‡§∞‡•ç‡§µ ‡§∏‡•ç‡§ü‡§æ‡§à‡§≤ ‡§Ø‡•á‡§•‡•á ‡§Ü‡§π‡•á‡§§. ‡§Æ‡•Ä ‡§Æ‡•Ç‡§≥ ‡§∏‡•ç‡§ü‡§æ‡§à‡§≤ ‡§Ø‡•á‡§•‡•á ‡§ï‡•â‡§™‡•Ä ‡§ï‡§∞‡§£‡•ç‡§Ø‡§æ‡§ö‡•Ä ‡§ó‡§∞‡§ú ‡§®‡§æ‡§π‡•Ä, ‡§™‡§£ ‡§§‡•Å‡§Æ‡•ç‡§π‡•Ä ‡§§‡•ç‡§Ø‡§æ ‡§§‡§∂‡§æ‡§ö ‡§†‡•á‡§µ‡§æ. 
           ‡§´‡§ï‡•ç‡§§ ‡§ñ‡§æ‡§≤‡•Ä ‡§¶‡§ø‡§≤‡•á‡§≤‡•ç‡§Ø‡§æ ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡§Æ‡§ß‡•ç‡§Ø‡•á URL ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡•á‡§≤‡•Ä ‡§Ü‡§π‡•á. */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { background: linear-gradient(145deg, #e0e5ec, #f0f4fa); min-height: 100vh; padding: 24px; display: flex; align-items: center; justify-content: center; }
        .dashboard { max-width: 1400px; width: 100%; display: flex; gap: 24px; height: 92vh; }
        .main { flex: 1; background: rgba(255,255,255,0.85); backdrop-filter: blur(16px); border-radius: 40px; padding: 28px; display: flex; flex-direction: column; box-shadow: 0 25px 45px -15px rgba(0,30,60,0.25); border: 1px solid rgba(255,255,255,0.7); }
        .main-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; }
        .main h2 { font-size: 1.8rem; font-weight: 700; color: #0b2b4a; }
        .theme-toggle { background: rgba(255,255,255,0.75); border: 1px solid #ddd; border-radius: 50px; padding: 8px 16px; cursor: pointer; display: flex; align-items: center; gap: 8px; }
        .sidebar { width: 300px; display: flex; flex-direction: column; gap: 18px; }
        .card { background: rgba(255,255,255,0.75); backdrop-filter: blur(12px); padding: 22px 20px; border-radius: 32px; border: 1px solid #fff; }
        .card h4 { font-size: 0.95rem; color: #0b2b4a; margin-bottom: 16px; border-bottom: 2px solid rgba(26,115,232,0.2); padding-bottom: 10px; }
        .card input { width: 100%; padding: 14px 18px; margin-bottom: 18px; border-radius: 24px; border: 1px solid #ddd; outline: none; }
        .btn { width: 100%; padding: 14px; border: none; border-radius: 40px; font-weight: 600; color: white; cursor: pointer; }
        .card:nth-child(1) .btn { background: #5f6368; } /* Status */
        .card:nth-child(2) .btn { background: #34a853; } /* Certificate */
        .card:nth-child(3) .btn { background: #d93025; } /* Document */
        .card:nth-child(4) .btn { background: #1a73e8; } /* Affidavit */
        .search-box { width: 100%; padding: 18px 28px; border-radius: 60px; border: 1px solid #ddd; margin-bottom: 24px; font-size: 1rem; }
        .table-wrap { flex: 1; overflow-y: auto; border-radius: 28px; background: rgba(255,255,255,0.4); border: 1px solid #fff; }
        table { width: 100%; border-collapse: collapse; font-size: 0.85rem; min-width: 850px; }
        th { background: #1a73e8; color: white; padding: 18px 16px; position: sticky; top: 0; }
        td { padding: 16px; border-bottom: 1px solid rgba(0,0,0,0.05); background: rgba(255,255,255,0.3); }
        .sr-no { background: rgba(26,115,232,0.2); padding: 5px 10px; border-radius: 30px; display: inline-block; }
        .id-container { display: flex; align-items: center; gap: 5px; flex-wrap: wrap; }
        .id-number { font-family: monospace; background: rgba(255,255,255,0.7); padding: 4px 8px; border-radius: 30px; border: 1px solid #1a73e8; }
        .copy-btn { background: white; border: 1px solid #1a73e8; color: #1a73e8; font-size: 0.65rem; padding: 4px 8px; border-radius: 30px; cursor: pointer; }
        .copy-btn.copied { background: #34a853; color: white; border-color: #34a853; }
        .name-download-container { display: flex; align-items: center; justify-content: space-between; gap: 5px; }
        .status-badge { background: #dff0d8; color: #1f5130; padding: 4px 8px; border-radius: 40px; font-size: 0.7rem; border: 1px solid #bde0bd; }
        .download-btn { background: #34a853; color: white; padding: 4px 10px; border-radius: 30px; font-size: 0.65rem; border: none; cursor: pointer; }
        #loader { text-align: center; padding: 15px; display: none; background: rgba(255,255,255,0.6); border-radius: 60px; margin-bottom: 16px; }
        .loader-spinner { display: inline-block; width: 18px; height: 18px; border: 3px solid rgba(26,115,232,0.2); border-top: 3px solid #1a73e8; border-radius: 50%; animation: spin 0.8s linear infinite; margin-right: 8px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        th:nth-child(1) { width: 70px; } th:nth-child(2) { min-width: 180px; } th:nth-child(3) { width: 90px; } th:nth-child(4) { min-width: 300px; } th:nth-child(5) { min-width: 230px; }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>

<div class="dashboard">
    <div class="main">
        <div class="main-header">
            <h2>üîé CSC ‡§°‡•á‡§ü‡§æ ‡§∂‡•ã‡§ß ¬∑ ‡§™‡•ç‡§∞‡•Ä‡§Æ‡§ø‡§Ø‡§Æ ‡§Ü‡§µ‡•É‡§§‡•ç‡§§‡•Ä</h2>
            <button class="theme-toggle" onclick="toggleTheme()" id="themeToggle">
                <span class="icon" id="themeIcon">üåû</span>
                <span id="themeText">Light Mode</span>
            </button>
        </div>
        <input type="text" id="searchInput" class="search-box" placeholder="‡§®‡§æ‡§µ, ID, ‡§ï‡§ø‡§Ç‡§µ‡§æ ‡§∏‡•á‡§µ‡§æ ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞‡§æ..." oninput="search(this.value)">
        <div id="loader"><span class="loader-spinner"></span> ‡§≤‡•ã‡§° ‡§π‡•ã‡§§ ‡§Ü‡§π‡•á...</div>
        <div class="table-wrap">
            <table>
                <thead><tr><th>‡§ï‡•ç‡§∞.</th><th>‡§∏‡•á‡§µ‡§æ ‡§®‡§æ‡§µ</th><th>‡§§‡§æ‡§∞‡•Ä‡§ñ</th><th>‡§Ö‡§∞‡•ç‡§ú ‡§ï‡•ç‡§∞‡§Æ‡§æ‡§Ç‡§ï</th><th>‡§®‡§æ‡§µ / ‡§°‡§æ‡§ä‡§®‡§≤‡•ã‡§°</th></tr></thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
    </div>
    <div class="sidebar">
        <div class="card"><h4>üìä ‡§∏‡•ç‡§ü‡•á‡§ü‡§∏</h4><button class="btn" onclick="go('st')">‡§ö‡•á‡§ï ‡§∏‡•ç‡§ü‡•á‡§ü‡§∏</button></div>
        <div class="card"><h4>üìú ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡§™‡§§‡•ç‡§∞</h4><input type="text" id="d_id" placeholder="App ID"><button class="btn" onclick="go('dl')">‡§°‡§æ‡§ä‡§®‡§≤‡•ã‡§°</button></div>
        <div class="card"><h4>üìé ‡§¶‡§∏‡•ç‡§§‡§ê‡§µ‡§ú</h4><input type="text" id="u_id" placeholder="App ID"><button class="btn" onclick="go('up')">‡§Ö‡§™‡§≤‡•ã‡§°</button></div>
        <div class="card"><h4>üìÑ ‡§™‡•ç‡§∞‡§§‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§§‡•ç‡§∞</h4><input type="text" id="p_id" placeholder="App ID"><button class="btn" onclick="go('print')">‡§™‡•ç‡§∞‡§ø‡§Ç‡§ü ‡§ï‡§∞‡§æ</button></div>
    </div>
</div>

<script>
    // üî¥ ‡§§‡•Å‡§Æ‡§ö‡•Ä ‡§¶‡§ø‡§≤‡•á‡§≤‡•Ä Google Apps Script Web App URL ‡§Ø‡•á‡§•‡•á ‡§ü‡§æ‡§ï‡§≤‡•Ä ‡§Ü‡§π‡•á
    const GAS_URL = 'https://script.google.com/macros/s/AKfycbycukyycNmaplKec5L9ou5JWnpfWZ4dfepBevzkD2ot4FxrK_xv1Bh0KE-Iw3j4BVYj/exec';

    // Theme Toggle Functions (‡§§‡§∂‡•ç‡§Ø‡§æ‡§ö ‡§†‡•á‡§µ‡§≤‡•ç‡§Ø‡§æ ‡§Ü‡§π‡•á‡§§)
    function toggleTheme() {
        const body = document.body;
        const themeIcon = document.getElementById('themeIcon');
        const themeText = document.getElementById('themeText');
        body.classList.toggle('dark-theme');
        if (body.classList.contains('dark-theme')) {
            themeIcon.textContent = 'üåô'; themeText.textContent = 'Dark Mode';
            localStorage.setItem('theme', 'dark');
        } else {
            themeIcon.textContent = 'üåû'; themeText.textContent = 'Light Mode';
            localStorage.setItem('theme', 'light');
        }
    }

    window.onload = function() {
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') { document.body.classList.add('dark-theme'); document.getElementById('themeIcon').textContent = 'üåô'; document.getElementById('themeText').textContent = 'Dark Mode'; }
        loadFromGitHub(""); // GitHub ‡§∏‡§æ‡§†‡•Ä ‡§®‡•á‡§π‡§Æ‡•Ä ‡§π‡•Ä ‡§™‡§¶‡•ç‡§ß‡§§ ‡§µ‡§æ‡§™‡§∞‡§æ
    };

    let timer;
    function search(v) {
        clearTimeout(timer);
        timer = setTimeout(function() { loadFromGitHub(v); }, 500);
    }

    // ===== GitHub Mode (JSONP - CORS ‡§è‡§∞‡§∞ ‡§∏‡•ã‡§°‡§µ‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä) =====
    function loadFromGitHub(q) {
        var loader = document.getElementById('loader');
        loader.style.display = 'block';

        var callbackName = 'gas_callback_' + Date.now();
        window[callbackName] = function(response) {
            loader.style.display = 'none';
            delete window[callbackName];
            if (script && script.parentNode) script.parentNode.removeChild(script);
            if (response && response.error) { alert(response.error); showDemoData(); return; }
            render(response || []);
        };

        var script = document.createElement('script');
        script.src = GAS_URL + '?query=' + encodeURIComponent(q) + '&callback=' + callbackName;

        script.onerror = function() {
            loader.style.display = 'none';
            console.log("JSONP ‡§ï‡•â‡§≤ ‡§Ö‡§Ø‡§∂‡§∏‡•ç‡§µ‡•Ä, ‡§°‡•á‡§Æ‡•ã ‡§°‡•á‡§ü‡§æ ‡§¶‡§æ‡§ñ‡§µ‡§§‡•ã.");
            delete window[callbackName];
            if (script && script.parentNode) script.parentNode.removeChild(script);
            showDemoData();
        };

        document.head.appendChild(script);
    }

    // ‡§°‡•á‡§Æ‡•ã ‡§°‡•á‡§ü‡§æ (‡§ú‡§∞ Apps Script ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§∏‡•á‡§≤ ‡§§‡§∞)
    function showDemoData() {
        const demoData = [
            { srNo: '101', service: 'Income Certificate', date: '10/02/2025', id: 'CSC2402A11', name: '‡§∞‡§æ‡§ú‡•á‡§∂ ‡§∂‡§∞‡•ç‡§Æ‡§æ' },
            { srNo: '102', service: 'Non-Creamy Layer', date: '09/02/2025', id: 'CSC2402B45', name: '‡§∏‡§µ‡§ø‡§§‡§æ ‡§™‡§æ‡§ü‡•Ä‡§≤' },
            { srNo: '103', service: 'Age Nationality', date: '08/02/2025', id: 'CSC2402C78', name: '‡§ó‡§£‡•á‡§∂ ‡§ï‡§¶‡§Æ' },
            { srNo: '104', service: 'Income Certificate', date: '07/02/2025', id: 'CSC2402D92', name: '‡§™‡•ç‡§∞‡§ø‡§Ø‡§Ç‡§ï‡§æ ‡§ú‡§æ‡§ß‡§µ' },
            { srNo: '105', service: 'Migrant Caste', date: '06/02/2025', id: 'CSC2402E33', name: '‡§∏‡•Ç‡§∞‡§ú ‡§Ø‡§æ‡§¶‡§µ' }
        ];
        render(demoData);
    }

    function render(data) {
        var tbody = document.getElementById('tableBody');
        if (!data || data.length === 0) {
            tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;padding:40px;">üîç ‡§ï‡•ã‡§£‡§§‡§æ‡§π‡•Ä ‡§°‡•á‡§ü‡§æ ‡§∏‡§æ‡§™‡§°‡§≤‡§æ ‡§®‡§æ‡§π‡•Ä</td></tr>';
            return;
        }
        var html = '';
        for (var i = 0; i < data.length; i++) {
            var r = data[i];
            var srNo = r.srNo || '-';
            var id = (r.id || '').replace(/'/g, "\\'");
            html += '<tr>' +
                '<td><span class="sr-no">' + srNo + '</span></td>' +
                '<td><b>' + (r.service || '') + '</b></td>' +
                '<td>' + (r.date || '') + '</td>' +
                '<td><div class="id-container"><span class="id-number">' + (r.id || '') + '</span><button class="copy-btn" onclick="copyId(\'' + id + '\', this)">üìã ‡§ï‡•â‡§™‡•Ä</button></div></td>' +
                '<td><div class="name-download-container"><span class="status-badge" title="' + (r.name || '') + '">' + (r.name || '') + '</span><button class="download-btn" onclick="openPDF(\'' + (r.id || '') + '\')">‚¨áÔ∏è PDF</button></div></td>' +
            '</tr>';
        }
        tbody.innerHTML = html;
    }

    function copyId(id, buttonElement) {
        navigator.clipboard.writeText(id).then(function() {
            buttonElement.classList.add('copied'); buttonElement.innerHTML = '‚úì ‡§ï‡•â‡§™‡•Ä';
            setTimeout(function() { buttonElement.classList.remove('copied'); buttonElement.innerHTML = 'üìã ‡§ï‡•â‡§™‡•Ä'; }, 2000);
        }).catch(function(err) {
            var el = document.createElement('textarea'); el.value = id; document.body.appendChild(el); el.select(); document.execCommand('copy'); document.body.removeChild(el);
            buttonElement.classList.add('copied'); buttonElement.innerHTML = '‚úì ‡§ï‡•â‡§™‡•Ä';
            setTimeout(function() { buttonElement.classList.remove('copied'); buttonElement.innerHTML = 'üìã ‡§ï‡•â‡§™‡•Ä'; }, 2000);
        });
    }

    function openPDF(id) {
        if (!id) { alert("PDF ‡§â‡§ò‡§°‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä ID ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§Ü‡§π‡•á"); return; }
        window.open("https://cscservices.mahaonline.gov.in/Edistrict/Handler/GetFile.ashx?From=ApplicationStatus&ID=" + id + "&sDist=529", '_blank');
    }

    function go(type) {
        var id = "", url = "";
        if (type === 'print') { id = document.getElementById('p_id').value; url = "https://cscservices.mahaonline.gov.in/General_Affidavit/GeneralAffidavitCertificateEn.aspx?AppID=" + id + "&ServiceId=1268"; }
        else if (type === 'dl') { id = document.getElementById('d_id').value; url = "https://cscservices.mahaonline.gov.in/Edistrict/Handler/GetFile.ashx?From=ApplicationStatus&ID=" + id + "&sDist=529"; }
        else if (type === 'up') { id = document.getElementById('u_id').value; url = "https://cscservices.mahaonline.gov.in/Edistrict/WorkFlow/Attachment.aspx?ApplicantId=" + id + "&ServiceID=1253&ID=INIT"; }
        else if (type === 'st') { url = "https://revenue.mahaonline.gov.in/ApplicationSearchStatus/ApplicationStatus.aspx?ServiceID=1&sDist=529"; }
        if (type !== 'st' && !id) { alert("‚ùå ‡§ï‡•É‡§™‡§Ø‡§æ App ID ‡§ü‡§æ‡§ï‡§æ"); return; }
        window.open(url, "_blank");
    }
</script>
</body>
</html>
